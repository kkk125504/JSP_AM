### topBar.jspf 추가, 메인, 리스트, 디테일 페이지에 적용

**1\) MainPageServlet **

```java
		HttpSession session = request.getSession();
		
		boolean isLogined = false;
		int loginedMemberId = -1;
		Map<String , Object> memberRow = null;
		if(session.getAttribute("loginedMemberLoginId") != null) {
			isLogined =  true;
			loginedMemberId = (int)session.getAttribute("loginedMemberId");
			SecSql sql = SecSql.from("SELECT * FROM `member`");
			sql.append("WHERE id = ?", loginedMemberId);				
			memberRow = DBUtil.selectRow(conn, sql);
		}
					
		request.setAttribute("isLogined", isLogined);
		request.setAttribute("loginedMemberId", loginedMemberId);		
		request.setAttribute("memberRow", memberRow);		
		request.getRequestDispatcher("/jsp/home/main.jsp").forward(request, response);
```

- 세션에 로그인회원에 관한정보(로그인아이디와 회원번호)가 있다면 회원번호를 이용해 로그인한 회원에대한 정보를 DB에서 Map타입으로 가져옴
- 로그인이 되있다면 isLogined =  true, loginedMemberId, memberRow를 main.jsp로 전달

**2\) main.jsp **

```jsp
<title>메인 페이지</title>
</head>
<body>
	<h1>메인 페이지</h1>
	<%@ include file="/jsp/part/topBar.jspf" %>
</body>
</html>
```

- main.jsp 에서는 topBar.jspf파일을 include하고있다.

**3\) topBar.jspf **


```jsp
    <%@ page import="java.util.List"%>
    <%@ page import="java.util.Map"%>
    <%@ page language="java" contentType="text/html; charset=UTF-8"
        pageEncoding="UTF-8"%>
    <div>
     <%
     boolean isLogined = (boolean) request.getAttribute("isLogined");
     int loginedMemberId = (int) request.getAttribute("loginedMemberId");
     Map<String, Object> memberRow = (Map<String, Object>) request.getAttribute("memberRow");
     %>
  
    <% if (isLogined == false) { %>
    	<div>     
      	  <a href="../member/login">로그인</a> <a href="../member/join">회원가입</a>
    	</div>
    <% } %>

    <% if (isLogined == true) { %>
    	<div>
       	  <%=memberRow.get("name")%>님 환영합니다. <a href="../member/logout">로그아웃</a>
    	</div>
    <% } %>
    </div>
    
	<div>
        <a href="../article/list">게시물 리스트</a>
    </div>
```
- 메인페이지 , 리스트페이지 , 디테일페이지에 topBar.jspf를 include
- topBar.jspf를 include하려면 isLogined, loginedMemberId, memberRow에대한 정보를 서블릿측에서 전달해야한다
- 리스트.jsp , 디테일.jsp에서 topBar.jspf include하기위해  
- 메인서블릿에서 했던 DB 연결(memberRow), 세션에서의 로그인 여부 판별(isLogined, loginedMemberId)을 리스트 , 디테일 서블릿에서도 동일하게 적용
